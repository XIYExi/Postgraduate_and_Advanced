# 结构化设计

- 模块化
- 抽象
- 逐步求精
- 信息屏蔽
- 模块独立

## 模块化

“模块”又称“构件”，一般指用一个名字调用的相邻程序元素序列。
模块化设计需按适当的原则把软件划分成一个个较小的、相关而又相对独立的模块。

[![ppkNnXt.md.png](https://s1.ax1x.com/2023/03/03/ppkNnXt.md.png)](https://imgse.com/i/ppkNnXt)

[![ppkNM0f.md.png](https://s1.ax1x.com/2023/03/03/ppkNM0f.md.png)](https://imgse.com/i/ppkNM0f)

## 抽象与求精

**抽象**指抽出事物的本质特性，不考虑细节。
**求精**指为了能集中精力解决主要问题，尽量推迟对细节问题得考虑，实际上是一个细化的过程，与抽象是互补的概念。
抽象使得设计者能够说明过程和数据，同时却忽略底层细节。
求精帮助设计者在设计过程中揭示底层细节。

## 信息屏蔽

每个模块的设计细节对于其他模块来说是隐藏的，也即是说，模块中所包含的信息是不允许其他不需要这些信息的模块访问的。
每个客户只能通过接口来了解该模块，而所有实现都隐藏起来。

[![ppkNNXq.md.png](https://s1.ax1x.com/2023/03/03/ppkNNXq.md.png)](https://imgse.com/i/ppkNNXq)

## 模块独立

具有独立功能且和其他模块没有过多作用。

1. 容易分工合作
2. 容易测试和维护，修改工作量较小，错误传播范围小，扩充功能容易。

> 两个定性度量标准：**耦合**和**内聚**

### 耦合

软件结构中不同模块间互连程度度量。
取决模块间接口复杂程度，通过接口数据。
追求尽可能松散耦合系统。

> **原则**
> 尽量使用数据耦合，少用控制耦合，限制公共环境耦合，完全不适用内容耦合。

[![ppkNrh4.png](https://s1.ax1x.com/2023/03/03/ppkNrh4.png)](https://imgse.com/i/ppkNrh4)

#### 非直接耦合

两个模块分别能独立地工作，不需要另一个模块存在。

#### 数据耦合

两模块通过参数交换数据信息。

#### 控制耦合

两模块参数交换控制信息（包括数字形式）

[![ppkNccR.png](https://s1.ax1x.com/2023/03/03/ppkNccR.png)](https://imgse.com/i/ppkNccR)

#### 公共环境耦合（类似 redux）

两个或多个模块通过一公共数据环境作用

[![ppkNRnx.png](https://s1.ax1x.com/2023/03/03/ppkNRnx.png)](https://imgse.com/i/ppkNRnx)

两种可能：

1. 一个模块送数据，另一个模块取数据，等价数据耦合。
2. 两个模块既往公共环境送又从里面取，介于数据耦合和控制耦合之间。

[![ppkN4AO.md.png](https://s1.ax1x.com/2023/03/03/ppkN4AO.md.png)](https://imgse.com/i/ppkN4AO)

#### 内容耦合

1. 一模块访问另一模块内部数据
2. 一模块不通过正常入口转到另一模块内部
3. 两模块有部分程序代码重叠（汇编程序）
4. 一模块有多个入口

[![ppkNT9H.md.png](https://s1.ax1x.com/2023/03/03/ppkNT9H.md.png)](https://imgse.com/i/ppkNT9H)

### 内聚

模块内各个元素笔记结合紧密程度。

[![ppkadFU.md.png](https://s1.ax1x.com/2023/03/03/ppkadFU.md.png)](https://imgse.com/i/ppkadFU)

#### 功能内聚

一模块中各部分是完成某一功能必不可少组成部分

#### 顺序内聚

模块内处理元素同某功能密切相关，顺序执行

#### 通信内聚

一模块内各功能部分都使用相同输入数据，或产生相同输出数据

[![ppkaZLt.png](https://s1.ax1x.com/2023/03/03/ppkaZLt.png)](https://imgse.com/i/ppkaZLt)

#### 过程内聚

模块内处理元素相关，特定次序执行。如把流程图中循环部分、判断部分、计算部分分为三个模块，这三个模块都是过程内聚模块。

[![ppkauo8.md.png](https://s1.ax1x.com/2023/03/03/ppkauo8.md.png)](https://imgse.com/i/ppkauo8)

#### 时间内聚

多为多功能模块，要求所有功能在同一时间内执行。如初始化模块和终止模块及紧急故障处理模块。

#### 逻辑模块

一个模块完成功能在逻辑上属于相同相似一类。

[![ppkalWQ.png](https://s1.ax1x.com/2023/03/03/ppkalWQ.png)](https://imgse.com/i/ppkalWQ)

#### 偶然内聚

模块内部各部分之间没有联系，即使有也很松散。

## 启发式规则

- **改进软件结构提高模块独立性**
  初步结构分解或合并，降低耦合提高内聚。

[![ppkagw6.png](https://s1.ax1x.com/2023/03/03/ppkagw6.png)](https://imgse.com/i/ppkagw6)

- **模块规模应该适中**
  过大说明分解不充分，但进一步分解不应该降低模块独立性。
  过小说明开销大于有效操作，模块数目过多系统接口复杂。
  通常语句行数在 50~100 行，最多不超过 500 行。

- **深度、宽度、扇出和扇入应该适当**

[![ppkahfe.md.png](https://s1.ax1x.com/2023/03/03/ppkahfe.md.png)](https://imgse.com/i/ppkahfe)

深度：软件结构控制层数，标志一个系统的大小和复杂程度。
宽度：软件结构同一层模块数最大值，越大说明系统越复杂。
扇出：一个模块直接控制（调用）的模块数，过大说明模块复杂，多小说明不好。控制在 3~9 之间。
扇入：指有多少个上级模块直接调用它，越大共享该模块的上级模块越多。

[![ppkdS6s.md.png](https://s1.ax1x.com/2023/03/03/ppkdS6s.md.png)](https://imgse.com/i/ppkdS6s)

- **模块作用域应该在控制域之内**
  作用域：受该模块内判定影响的所有模块集合。
  控制域：模块本身及所有直接或间接从属它的模块集合。
  若控制作用域不在控制域内，会增加模块间控制耦合。

改善一：判定点上移
改善二：将作用域不在控制域内的模块下移到控制域中

- **降低模块接口复杂程度**
  模块接口复杂是软件发生错误的一个主要原因，应使信息传递简单且模块功能一致。

- **设计单入口、单出口模块**
  避免内容耦合

- **模块功能可预测**
  输入数据相同，产生同样输出。模块功能防止过分受限。
